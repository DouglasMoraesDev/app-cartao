<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />

  <!-- 1) Meta para theme-color, com id para aplicaÃ§Ã£o de cor dinÃ¢mica -->
  <meta name="theme-color" content="#ffffff" id="theme-color-meta" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CartÃ£o Fidelidade â€“ Dashboard</title>

  <!-- 2) Manifest e Ã­cones -->
  <link rel="icon" href="/logo/icon.png" sizes="192x192" />
  <link rel="icon" href="/logo/icon.png" sizes="512x512" />
  <link rel="apple-touch-icon" href="/logo/icon.png" sizes="180x180" />
  <link rel="shortcut icon" href="/logo/icon.png" />

  <!-- 3) CSS global -->
  <link rel="stylesheet" href="/css/style.css" />

  <!-- 4) Fontes Google -->
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500&amp;family=Oxanium:wght@200..800&amp;display=swap"
    rel="stylesheet"
  />

  <!-- 5) Scripts na ordem correta:
       - api.js (wrapper para fetch + tratamento de 401/402)
       - theme.js (define applyTheme e renderQRCode)
       - clients.js (define loadClients, setupClientsListeners, renderClientsList, etc.)
       - addPoints.js (define setupAddPointsListeners, onSearchPoints, etc.)
       - notifications.js (define setupNotificationsListeners, loadNotifications, etc.)
       - dashboard.js (usa todas essas funÃ§Ãµes para inicializar a dashboard)
  -->
  <script src="/js/api.js" defer></script>
  <script src="/js/theme.js" defer></script>
  <script src="/js/clients.js" defer></script>
  <script src="/js/addPoints.js" defer></script>
  <script src="/js/notifications.js" defer></script>
  <script src="/js/dashboard.js" defer></script>
</head>
<body>
  <!-- ======== Estrutura do Dashboard ========= -->

  <!-- Login -->
  <div id="loginDiv" class="container" style="display: none;">
    <h2>Login</h2>
    <label for="username">UsuÃ¡rio:</label>
    <input type="text" id="username" placeholder="Digite seu nome de usuÃ¡rio" />
    <label for="password">Senha:</label>
    <input type="password" id="password" placeholder="Digite sua senha" />
    <button id="loginBtn">Entrar</button>
  </div>

  <!-- Dashboard -->
  <div id="dashboard" style="display: none;">
    <!-- Header com logo e mensagem de boas-vindas -->
    <div class="dashboard-container header-container">
      <div>
        <h1>CartÃ£o Fidelidade</h1>
        <p id="welcome-msg">
          OlÃ¡, seja bem-vindo de volta, <span id="user-name"></span>!
        </p>
      </div>
      <img id="logo" src="/logo/" alt="Logo do estabelecimento" />
    </div>

    <!-- Menu de abas (cada botÃ£o exibe uma seÃ§Ã£o dentro desta mesma pÃ¡gina) -->
    <nav class="tab-menu">
      <button class="active" data-section="tab-clients">ðŸ‘¤ Cadastrar Cliente</button>
      <button data-section="tab-add-points">âž• Adicionar Pontos</button>
      <button data-section="tab-table">ðŸ“‹ Tabela Clientes</button>
      <button data-section="tab-notify">ðŸ”” NotificaÃ§Ãµes</button>
      <button data-section="tab-qr">ðŸ“· Consultar Pontos</button>
      <a href="login.html"><button>Sair</button></a>
    </nav>

    <!-- ======== SeÃ§Ãµes de ConteÃºdo (tab-content) ======== -->

    <!-- 1) Cadastrar Cliente -->
    <section id="tab-clients" class="tab-content">
      <div class="dashboard-container">
        <h3>Adicionar Novo Cliente</h3>
        <label for="clientFullName">Nome Completo:</label>
        <input
          type="text"
          id="clientFullName"
          placeholder="Nome Completo do Cliente"
        />
        <label for="clientPhone">NÃºmero de Telefone:</label>
        <input
          type="text"
          id="clientPhone"
          placeholder="NÃºmero de Telefone"
        />
        <label for="clientEmail">Email:</label>
        <input type="email" id="clientEmail" placeholder="Email do Cliente" />
        <label for="clientPoints">Pontos:</label>
        <input
          type="number"
          id="clientPoints"
          min="0"
          value="0"
        />
        <button id="saveClientBtn">Salvar Cliente</button>
      </div>
    </section>

    <!-- 2) Adicionar Pontos -->
    <section
      id="tab-add-points"
      class="tab-content"
      style="display: none;"
    >
      <div class="dashboard-container">
        <h3>Adicionar Pontos</h3>
        <input
          type="text"
          id="searchPointsInput"
          placeholder="ðŸ”Ž Pesquisar cliente..."
        />
        <button id="searchPointsBtn">Buscar</button>
        <div id="addPointsCardContainer"></div>
      </div>
    </section>

    <!-- 3) Tabela de Clientes (Lista FiltrÃ¡vel) -->
    <section
      id="tab-table"
      class="tab-content"
      style="display: none;"
    >
      <div class="dashboard-container">
        <input
          type="text"
          id="searchClientsInput"
          placeholder="ðŸ”Ž Pesquisar cliente..."
        />
        <ul id="clientsList"></ul>
      </div>

      <!-- Card de detalhes do cliente (invisÃ­vel atÃ© o clique) -->
      <div id="clientDetailCard">
        <button id="closeDetailCard">âœ–</button>
        <h3 id="detailName"></h3>
        <p>
          <strong>Email:</strong>
          <span id="detailEmail"></span>
        </p>
        <p>
          <strong>Telefone:</strong>
          <span id="detailPhone"></span>
        </p>
        <p>
          <strong>Pontos:</strong>
          <span id="detailPoints"></span>
        </p>
      </div>
      <div id="detailBackdrop"></div>
    </section>

    <!-- 4) NotificaÃ§Ãµes (Clientes com â‰¥10 Pontos) -->
    <section
      id="tab-notify"
      class="tab-content"
      style="display: none;"
    >
      <div class="dashboard-container">
        <h3>Clientes com 10 Pontos</h3>
        <ul id="clients"></ul>
      </div>
    </section>

    <!-- 5) Consultar Pontos via QR Code -->
    <section
      id="tab-qr"
      class="tab-content"
      style="display: none;"
    >
      <div class="dashboard-container">
        <h3>QR Code para consulta de pontos</h3>
        <img id="qrCodeImg" alt="QR Code do estabelecimento" />
        <p>
          Ou abra diretamente:
          <a id="pointsLink" href="#" target="_blank"
            >Consultar meus pontos</a
          >
        </p>
      </div>
    </section>
  </div>

  <!-- Footer fixo no fim da pÃ¡gina -->
  <footer>
    <p>
      &copy; Douglas Moraes Dev<br />
      <a href="https://wa.me/qr/F2Z744R5KWEPB1" target="_blank"
        >Contato</a
      >
    </p>
  </footer>
</body>
</html>
